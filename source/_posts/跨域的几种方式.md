---
title: è·¨åŸŸçš„å‡ ç§æ–¹å¼
date: 2018-11-27 12:10:17
tags: 
- æ‚
categories: 
- æ‚
---

# è·¨åŸŸçš„å‡ ç§æ–¹å¼

> å‚è€ƒèµ„æ–™ï¼šhttps://www.bilibili.com/video/av31173487?from=search&seid=17845079103401026420



#### 1.JSONP

#####  1) ä¸¾ä¸ªğŸŒ°ï¼Œæ‰“å¼€ç™¾åº¦æœç´¢

![](http://pi8irywwe.bkt.clouddn.com/WX20181127-122024@2x.png)



å¯ä»¥çœ‹è§è¯·æ±‚ä¸åœ¨XHRå†…ï¼Œè¯·æ±‚åœ°å€ä¸ºï¼š[https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=312&json=1&p=3&sid=26522_1448_27209_21127&req=2&bs=12306&pbs=12306&csor=1&pwd=12&cb=jQuery1102020631165172376442_1543288587207&_=1543288587300](https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=312&json=1&p=3&sid=26522_1448_27209_21127&req=2&bs=12306&pbs=12306&csor=1&pwd=12&cb=jQuery1102020631165172376442_1543288587207&_=1543288587300)



ä¿®æ”¹ä¸€ä¸‹è¯·æ±‚åœ°å€çš„æŸ¥è¯¢å‚æ•°`cb`éƒ¨åˆ†

[https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=312&json=1&p=3&sid=26522_1448_27209_21127&req=2&bs=12306&pbs=12306&csor=1&pwd=12&cb=show](https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=312&json=1&p=3&sid=26522_1448_27209_21127&req=2&bs=12306&pbs=12306&csor=1&pwd=12&cb=show)



ä»£ç å¦‚ä¸‹ï¼š

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>

    <script>
        function show(data) {
            console.log(data);
        }
    </script>
    <script src="https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su?wd=312&json=1&p=3&sid=26522_1448_27209_21127&req=2&bs=12306&pbs=12306&csor=1&pwd=12&cb=show"></script>

</body>

</html>
```

æœ€åæ‰“å°å‡ºç»“æœ

![](http://pi8irywwe.bkt.clouddn.com/WX20181127-123151@2x.png)



##### 2) å®ç°ä¸€ä¸ªç®€å•JSONPä¾‹å­(è¿™é‡Œä½¿ç”¨koa)

```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>

    <button onclick="send()">send</button>

</body>
<script>
    function show(data) {
        console.log(data);//è¿™ä¸ªæ˜¯æ•°æ®
    }
</script>
<script>
    function send() {
     var script = document.createElement('script');
     script.setAttribute('src','http://127.0.0.1:3000/jsonp?callback=show');
     document.body.appendChild(script);
    }
</script>

</html>
```

koa:

```js
const koa = require('koa');
const app = new koa();

const Router = require('koa-router');
const router = new Router();

router.get('/jsonp', async (ctx, next) => {
    const req = ctx.request.query;
    console.log(req);
    const data = 'è¿™ä¸ªæ˜¯æ•°æ®';
    ctx.body = req.callback + '(' + JSON.stringify(data) + ')';//show("è¿™ä¸ªæ˜¯æ•°æ®")
})

app.use(router.routes());

app.listen(3000);
console.log('koa server is listening port 3000');
```



##### 3) JSONPçš„ç¼ºç‚¹

1.å¿…é¡»ä¼ å›è°ƒå‡½æ•°åç§°

2.åªæ”¯æŒgetè¯·æ±‚